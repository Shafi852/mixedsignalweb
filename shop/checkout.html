<!DOCTYPE html>
<html lang="en">

  <head>
    <title>Rent n Build</title>
    <meta charset="utf-8">

    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700,800" rel="stylesheet">
    <link rel="shortcut icon" href="../img/favicon.png" />
    <link rel="icon" href="../img/favicon.png" />
    <link rel="stylesheet" href="../css_shop/css/open-iconic-bootstrap.min.css">
    <link rel="stylesheet" href="../css_shop/css/animate.css">

    <link rel="stylesheet" href="../css_shop/css/owl.carousel.min.css">
    <link rel="stylesheet" href="../css_shop/css/owl.theme.default.min.css">
    <link rel="stylesheet" href="../css_shop/css/magnific-popup.css">

    <link rel="stylesheet" href="../css_shop/css/aos.css">

    <link rel="stylesheet" href="../css_shop/css/ionicons.min.css">

    <link rel="stylesheet" href="../css_shop/css/bootstrap-datepicker.css">
    <link rel="stylesheet" href="../css_shop/css/jquery.timepicker.css">


    <link rel="stylesheet" href="../css_shop/css/flaticon.css">
    <link rel="stylesheet" href="../css_shop/css/icomoon.css">
    <link rel="stylesheet" href="../css_shop/css/style.css">
  </head>
  <body class="goto-here">
    <button id="authorize_button" style="display: none;">Authorize</button>
        <button id="signout_button" style="display: none;">Sign Out</button>
		<div class="py-1 bg-black">
		<div class="container">
		  <div class="row no-gutters d-flex align-items-start align-items-center px-md-0">
			<div class="col-lg-12 d-block">
			  <div class="row d-flex">
				<div class="col-md pr-4 d-flex topper align-items-center">
				  <div class="icon mr-2 d-flex justify-content-center align-items-center"><ion-icon name="phone-portrait"></ion-icon></div>
				  <span class="text">Web Admin: +91 94967 88779</span>
				</div>
				<div class="col-md pr-4 d-flex topper align-items-center">
				  <div class="icon mr-2 d-flex justify-content-center align-items-center"><ion-icon name="mail"></ion-icon></div>
				  <span class="text">mixedsignals.mec.in@gmail.com</span>
				</div>
				<div class="col-md-5 pr-4 d-flex topper align-items-center text-lg-right">
				  <span class="text">Delivery at college only</span>
				</div>
			  </div>
			</div>
		  </div>
		</div>
	  </div>
	  <nav class="navbar navbar-expand-lg navbar-dark ftco_navbar bg-dark ftco-navbar-light" id="ftco-navbar">
		<div class="container">
		  <a class="navbar-brand" href="../shop1.html">Rent n Build</a>
		  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#ftco-nav" aria-controls="ftco-nav" aria-expanded="false" aria-label="Toggle navigation">
			<span class="oi oi-menu"></span> Menu
		  </button>

		  <div class="collapse navbar-collapse" id="ftco-nav">
			<ul class="navbar-nav ml-auto">
			  <li class="nav-item"><a href="../index.html" class="nav-link">Site Home</a></li>
			  <li class="nav-item"><a href="../shop1.html" class="nav-link">Shop Home</a></li>
			 <!-- <li class="nav-item dropdown active">
				<a class="nav-link dropdown-toggle" href="#" id="dropdown04" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Catalog</a>
				<div class="dropdown-menu" aria-labelledby="dropdown04">
				  <a class="dropdown-item" href="">Shop</a>
				  <a class="dropdown-item" href="product-single.html">Single Product</a>
				  <a class="dropdown-item" href="cart.html">Cart</a>
				  <a class="dropdown-item" href="checkout.html">Checkout</a>
				</div>
			  </li>-->
			  <li class="nav-item"><a href="../about-us.html" class="nav-link">About</a></li>
			  <li class="nav-item"><a href="https://github.com/KurienEapen/MixedSignals_Shop/blob/master/README.md" class="nav-link">How to use?</a></li>
			  <li class="nav-item cta cta-colored"><a href="cart.html" class="nav-link"><ion-icon name="cart"></ion-icon></a></li>

			</ul>
		  </div>
		</div>
	  </nav>
    <!-- END nav -->

    <div class="hero-wrap hero-bread" style="background-image: url('images/bg_6.jpg');">
      <div class="container">
        <div class="row no-gutters slider-text align-items-center justify-content-center">
          <div class="col-md-9 ftco-animate text-center">
          	<!--<p class="breadcrumbs"><span class="mr-2"><a href="index.html">Home</a></span> <span>Checkout</span></p>-->
            <h1 class="mb-0 bread">Checkout</h1>
          </div>
        </div>
      </div>
    </div>
    <section class="ftco-gallery">
			<div class="container">
				<div class="row justify-content-center">
					<div class="col-md-8 heading-section text-center mb-4 ftco-animate">
				<h2 class="mb-4">Terms and Conditions</h2>
				<p id="termsandconditions" align="justify"></p>
			  </div>
			</div>
			</div>
		</section>
    <section class="ftco-section">
      <div class="container">
        <div class="row justify-content-center">
          <div class="col-xl-10 ftco-animate">
						<form action="#" class="billing-form">
							<h3 class="mb-4 billing-heading">Billing Details</h3>
	          	<div class="row align-items-end">
	          		<div class="col-md-6">
	                <div class="form-group">
	                	<label for="firstname">First Name</label>
	                  <input type="text" class="form-control" placeholder="" id="firstname">
	                </div>
	              </div>
	              <div class="col-md-6">
	                <div class="form-group">
	                	<label for="lastname">Last Name</label>
	                  <input type="text" class="form-control" placeholder="" id="lastname">
	                </div>
                </div>
                <div class="w-100"></div>
		            <!--<div class="col-md-12">
		            	<div class="form-group">
		            		<label for="country">State / Country</label>
		            		<div class="select-wrap">
		                  <div class="icon"><span class="ion-ios-arrow-down"></span></div>
		                  <select name="" id="" class="form-control">
		                  	<option value="">France</option>
		                    <option value="">Italy</option>
		                    <option value="">Philippines</option>
		                    <option value="">South Korea</option>
		                    <option value="">Hongkong</option>
		                    <option value="">Japan</option>
		                  </select>
		                </div>
		            	</div>
		            </div>-->
		            <div class="w-100"></div>
		            <div class="col-md-6">
		            	<div class="form-group">
	                	<label for="class">Class</label>
	                  <input type="text" class="form-control" placeholder="eg:- EC7A" id="class">
	                </div>
					</div>
		            <div class="col-md-6">
		            	<div class="form-group">
	                	<label for="Roll Number">Admission Number</label>
	                  <input type="text" class="form-control" placeholder="eg:- 7522/16" id="rollno">
	                </div>
		            </div>
		            <!--<div class="col-md-6">
		            	<div class="form-group">
	                  <input type="text" class="form-control" placeholder="Appartment, suite, unit etc: (optional)">
	                </div>
		            </div>-->
		            <div class="w-100"></div>
		            <!--<div class="col-md-6">
		            	<div class="form-group">
	                	<label for="towncity">Town / City</label>
	                  <input type="text" class="form-control" placeholder="">
	                </div>
		            </div>
		            <div class="col-md-6">
		            	<div class="form-group">
		            		<label for="postcodezip">Postcode / ZIP *</label>
	                  <input type="text" class="form-control" placeholder="">
	                </div>
		            </div>-->
		            <div class="w-100"></div>
		            <div class="col-md-6">
	                <div class="form-group">
	                	<label for="phone">Phone</label>
	                  <input type="text" class="form-control" placeholder="" id="phone">
	                </div>
	              </div>
	              <div class="col-md-6">
	                <div class="form-group">
	                	<label for="emailaddress">Email Address</label>
	                  <input type="text" class="form-control" placeholder="" id="emailaddress">
	                </div>
                </div>
                <div class="w-100"></div>
                <!--<div class="col-md-12">
                	<div class="form-group mt-4">
										<div class="radio">
										  <label class="mr-3"><input type="radio" name="optradio"> Create an Account? </label>
										  <label><input type="radio" name="optradio"> Ship to different address</label>
										</div>
									</div>
                </div>-->
	            </div>
	          </form><!-- END -->



	          <div class="row mt-5 pt-3 d-flex">
	          	<div class="col-md-6 d-flex">
	          		<div class="cart-detail cart-total bg-light p-3 p-md-4">
	          			<h3 class="billing-heading mb-4">Cart Total</h3>
	          			<p class="d-flex">
		    						<span>Subtotal</span>
		    						<span id="subtotal">0</span>
		    					</p>
		    					<p class="d-flex">
		    						<span>Discount</span>
		    						<span id="discount">0</span>
		    					</p>
		    					<hr>
		    					<p class="d-flex total-price">
		    						<span>Total</span>
		    						<span id="total">0</span>
		    					</p>
								</div>
	          	</div>
	          	<div class="col-md-6">
	          		<div class="cart-detail bg-light p-3 p-md-4">
	          			<h3 class="billing-heading mb-4">Payment Method</h3>
									<div class="form-group">
										<div class="col-md-12">
											<div class="radio">
											   <label><input type="radio" name="optradio" class="mr-2" id="cashradio">Cash</label>
											</div>
										</div>
									</div>
									<div class="form-group">
										<div class="col-md-12">
											<div class="checkbox">
											   <label><input type="checkbox" value="" class="mr-2" id="termsbox"> I have read and accept the terms and conditions</label>
											</div>
										</div>
									</div>
									<p><a class="btn btn-primary py-3 px-4" id="order" onclick="order()">Place an order</a></p>
								</div>
	          	</div>
	          </div>
          </div> <!-- .col-md-8 -->
        </div>
      </div>
    </section> <!-- .section -->


    <footer class="ftco-footer ftco-section">
			<div class="container">
			  <div class="row">
				<div class="mouse">
				  <a href="#" class="mouse-icon">
					<div class="mouse-wheel"><ion-icon name="ios-arrow-up" size="large"></ion-icon></div>
				  </a>
				</div>
			  </div>
			  <div class="row mb-5">
				<div class="col-md">
				  <div class="ftco-footer-widget mb-4">
					<h2 class="ftco-heading-2">Rent n Build</h2>
					<p>This is an online shopping site by mixedsignals for renting electronic items at a bargain price.</p>
					<ul class="ftco-footer-social list-unstyled float-md-left float-lft mt-5">
					  <a href="https://twitter.com/MexMixed"><ion-icon name="logo-twitter" size="large"></ion-icon></a>
					  <a href="https://www.facebook.com/mixedsignalsmec/"><ion-icon name="logo-facebook" size="large"></span></a>
					</ul>
				  </div>
				</div>
				<div class="col-md">
				  <div class="ftco-footer-widget mb-4 ml-md-5">
					<h2 class="ftco-heading-2">Menu</h2>
					<ul class="list-unstyled">
					  <li><a href="shop1.html" class="py-2 d-block">Shop</a></li>
					  <li><a href="about-us.html" class="py-2 d-block">About</a></li>
					</ul>
				  </div>
				</div>
				<div class="col-md">
				  <div class="ftco-footer-widget mb-4">
					<h2 class="ftco-heading-2">Have a Question?</h2>
					<div class="block-23 mb-3">
					  <ul>
						<li><a href="https://www.google.com/maps/place/Model+Engineering+College/@10.0273396,76.3274078,17z/data=!4m13!1m7!3m6!1s0x3b080c5a87044b5d:0x1d45e225cbbc660a!2sModel+Engineering+College,+Thrikkakara,+Edappally,+Kochi,+Kerala+682021!3b1!8m2!3d10.0273253!4d76.3295369!3m4!1s0x3b080c5006491601:0xcf23e14245d4694d!8m2!3d10.0283636!4d76.3285124"><ion-icon name="pin" size="large"></ion-icon><span class="text"> Location</span></a></li>
						<li><a href="tel:+919496788779"><ion-icon name="call" size="large"></ion-icon><span class="text">Web Admin: +91 94967 88779</span></a></li>
						<li><a href="http://mixedsignals.mec.ac.in/"><ion-icon name="mail-open" size="large"></ion-icon><span class="text">mixedsignals@mec.ac.in</span></a></li>
					  </ul>
					</div>
				  </div>
				</div>
			  </div>
			  <div class="row">
				<div class="col-md-12 text-center">

				  <p>
					Copyright &copy;<script>document.write(new Date().getFullYear());</script> All rights reserved | <a href="http://mixedsignals.mec.ac.in" target="_blank">Mixed Signals</a>
				  </p>
				</div>
			  </div>
			</div>
		  </footer>



  <!-- loader -->
  <div id="ftco-loader" class="show fullscreen"><svg class="circular" width="48px" height="48px"><circle class="path-bg" cx="24" cy="24" r="22" fill="none" stroke-width="4" stroke="#eeeeee"/><circle class="path" cx="24" cy="24" r="22" fill="none" stroke-width="4" stroke-miterlimit="10" stroke="#F96D00"/></svg></div>


  <script src="../js_shop/jquery.min.js"></script>

  <script src="../js_shop/jquery-migrate-3.0.1.min.js"></script>
  <script src="../js_shop/popper.min.js"></script>
  <script src="../js_shop/jquery.easing.1.3.js"></script>
  <script src="../js_shop/jquery.waypoints.min.js"></script>
  <script src="../js_shop/jquery.stellar.min.js"></script>
  <script src="../js_shop/owl.carousel.min.js"></script>
  <script src="../js_shop/jquery.magnific-popup.min.js"></script>
  <script src="../js_shop/bootstrap.min.js"></script>
  <script src="../js_shop/aos.js"></script>
  <script src="../js_shop/jquery.animateNumber.min.js"></script>
  <script src="../js_shop/bootstrap-datepicker.js"></script>
  <script src="../js_shop/scrollax.min.js"></script>
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBVWaKrjvy3MaE7SQ74_uJiULgl1JY0H2s&sensor=false"></script>
  <script src="https://unpkg.com/ionicons@4.5.10-0/dist/ionicons.js"></script>
  <script src="../js_shop/google-map.js"></script>
  <script src="../js_shop/main.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
  <script src="https://smtpjs.com/v3/smtp.js"></script>
  <script async defer src="https://apis.google.com/js/api.js"
      onload="this.onload=function(){};handleClientLoad()"
      onreadystatechange="if (this.readyState === 'complete') this.onload()">
    </script>
  <script type="text/javascript">
      // Client ID and API key from the Developer Console
      var CLIENT_ID = '828283127076-is226se80keesbrh4o0b9t8qdv1prirs.apps.googleusercontent.com';
      var API_KEY = 'AIzaSyCZkvRWzg1xwJ9VKSOw1JT8XsZbLGLgLus';

      // Array of API discovery doc URLs for APIs used by the quickstart
      var DISCOVERY_DOCS = ["https://sheets.googleapis.com/$discovery/rest?version=v4"];

      // Authorization scopes required by the API; multiple scopes can be
      // included, separated by spaces.
      var SCOPES = "https://www.googleapis.com/auth/spreadsheets";

      var authorizeButton = document.getElementById('authorize_button');
      var signoutButton = document.getElementById('signout_button');

      /**
       *  On load, called to load the auth2 library and API client library.
       */
      function handleClientLoad() {
        gapi.load('client:auth2', initClient);
      }

      /**
       *  Initializes the API client library and sets up sign-in state
       *  listeners.
       */
      function initClient() {
        gapi.client.init({
          apiKey: API_KEY,
          clientId: CLIENT_ID,
          discoveryDocs: DISCOVERY_DOCS,
          scope: SCOPES
        }).then(function () {
          // Listen for sign-in state changes.
          gapi.auth2.getAuthInstance().isSignedIn.listen(updateSigninStatus);

          // Handle the initial sign-in state.
          updateSigninStatus(1);
          authorizeButton.onclick = handleAuthClick;
          signoutButton.onclick = handleSignoutClick;
        }, function(error) {
          appendPre(JSON.stringify(error, null, 2));
        });
      }

      /**
       *  Called when the signed in status changes, to update the UI
       *  appropriately. After a sign-in, the API is called.
       */
      function updateSigninStatus(isSignedIn) {
        if (isSignedIn) {
          authorizeButton.style.display = 'none';
          signoutButton.style.display = 'none';
          listMajors();
        } else {
          authorizeButton.style.display = 'block';
          signoutButton.style.display = 'none';
        }
      }

      /**
       *  Sign in the user upon button click.
       */
      function handleAuthClick(event) {
        gapi.auth2.getAuthInstance().signIn();
      }

      /**
       *  Sign out the user upon button click.
       */
      function handleSignoutClick(event) {
        gapi.auth2.getAuthInstance().signOut();
      }
      function quantremcal(i,quantity_remaining)
      {
        var id=parseInt(i)+2;
        //alert(quantity_remaining);
        var params = {
// The ID of the spreadsheet to update.
spreadsheetId: '1spWSrIWkejVr2k54jEuu6NzudbIK2KedWvvsxQ-DGUA',  // TODO: Update placeholder value.

// The A1 notation of the values to update.
range: 'Sheet1!H' + id,  // TODO: Update placeholder value.

// How the input data should be interpreted.
valueInputOption: 'USER_ENTERED',  // TODO: Update placeholder value.
};

var valueRangeBody = {
// TODO: Add desired properties to the request body. All existing properties
// will be replaced.
"values" : [[quantity_remaining]]
};

var request = gapi.client.sheets.spreadsheets.values.update(params, valueRangeBody);
request.then(function(response) {
// TODO: Change code below to process the `response` object:
//listMajors();
//cartquantity_get(message);
//alert('Added to cart');
console.log(response.result);
//var paragraph = document.getElementById("cartquantity");
//paragraph.removeChild(paragraph.childNodes[1]);
//rent_cartquantity_get(message);
//document.getElementById("rentnow").href = "cart.html"
//location.reload();
}, function(reason) {
console.error('error: ' + reason.result.error.message);
});
      }
      function mailbodygen_2(row)
      {
      	//alert("bcd");
        gapi.client.sheets.spreadsheets.values.get({
          spreadsheetId: '1spWSrIWkejVr2k54jEuu6NzudbIK2KedWvvsxQ-DGUA',
          range: 'Sheet1!A2:I',
        }).then(function(response) {
          var range = response.result;
          if (range.values.length > 0) {
            //var aarr = window.location.href.split('?');
            //var id = aarr[aarr.length -1];
            //var row=[];
            for (i = 0; i < range.values.length; i++) {
            	for(j=0;j< row.length;++j)
            	{
                  if(range.values[i][0]==row[j][0])
                  {
              	   row[j].push(parseInt(row[j][1])*parseInt(range.values[i][6]));
                   //alert("abc");
                   console.log(parseInt(range.values[i][7])-parseInt(row[j][1]));
                   var quantity_remaining = parseInt(range.values[i][7])-parseInt(row[j][1]);
                   if(parseInt(quantity_remaining)<0)
                   {
                   	$('.notifyjs-corner').empty();
                   	alert("One or more of the products have been sold out.\nPlease clear cart and order again.");
                    window.location.href="../shop1.html";
                   }
                   quantremcal(i,quantity_remaining);
                  }
            	}
              //var row = range.values[id];
              //var quantity = parseInt(row[1]);
              //addtag(ip,id,row[0],quantity,row[4],row[6]);
              //alert(tot);row[6]
            }
            console.log(row);
            var days=30; // Days you want to subtract
            var date = new Date();
            var after = new Date(date.getTime() + (days * 24 * 60 * 60 * 1000));
            var day_after =after.getDate();
            var month_after=after.getMonth()+1;
            var year_after=after.getFullYear();
            var day=date.getDate();
            var month=date.getMonth()+1;
            var year=date.getFullYear();
            var total = 0;
            var body=document.getElementById("firstname").value + ",<br /><br />" + "This is to confirm the order you have placed using the Mixed Signals Shopping site on " + day + "/" + month + "/" + year +".The list of the products you have order along with their prices are as follows:-<br /><br />";
            for (i=0;i<row.length;++i)
            {
             body=body + row[i][0] + "  x " + row[i][1] + " :- Rs " + row[i][2] + "<br />";
             //quantremcal()
             total =total + parseInt(row[i][2]);
            }
            body=body + "Total :- Rs " + total + "<br /><br />";
            body = body + "You are to collect these products from Ajo Sebastian EC7A(Roomno:- 515) (+918330872164) or Deepak TK EC7B(Roomno:- 511) (+917025254421) on the next working day during lunch break.The total amount mentioned above should be paid at the time of product collection.<br /><br />The last date for returning the rented products is " + day_after + "/" + month_after + "/" + year_after + ".<br />If you fail to cancel the order or collect the components within a week, you will be banned from the site.<br /><br />For cancellation of the above order and for further details please contact -<br />Sanjay(Web Admin Mixedsignals) - +91 94967 88779.<br /><br />Thanking you,<br />MixedSignals"
            var body_buyer = body;
            body = body + "<br /><br />" + document.getElementById("firstname").value + " " + document.getElementById("lastname").value + "<br />" + document.getElementById("class").value + "<br />" + document.getElementById("rollno").value + "<br />" + document.getElementById("phone").value + "<br />" + document.getElementById("emailaddress").value
        Email.send({
    Host : "smtp.gmail.com",
    Username : "mixedsignals.mec.in@gmail.com",
    Password : "lftubqrybyaavfjr",
    To : "mixedsignals.mec.in@gmail.com",
    From : "mixedsignals.mec.in@gmail.com",
    Subject : "MixedSignals Shop mail(Order Confirmation)",
    Body : body ,
    Attachments : [
	{
		name : "TERMS AND CONDITIONS.docx",
		path : "http://mixedsignals.mec.ac.in/shop/TERMS AND CONDITIONS.docx"
	}]
}).then(
  message => console.log(message)
  //alert("Thank you for shopping with us.\nWe have sent a mail to your Email address.");
  //window.location.href = "../shop1.html";
  );
        Email.send({
    Host : "smtp.gmail.com",
    Username : "mixedsignals.mec.in@gmail.com",
    Password : "lftubqrybyaavfjr",
    To : document.getElementById("emailaddress").value,
    From : "mixedsignals.mec.in@gmail.com",
    Subject : "MixedSignals Shop mail(Order Confirmation)",
    Body : body_buyer ,
    Attachments : [
	{
		name : "TERMS AND CONDITIONS.docx",
		path : "http://mixedsignals.mec.ac.in/shop/TERMS AND CONDITIONS.docx"
	}]
}).then(function () {
  message => console.log(message)
  $('.notifyjs-corner').empty();
  alert("Thank you for shopping with us.\nWe have sent a mail to your Email address.");
  window.location.href = "../shop1.html";
});

            //mailbodygen_2(row);
          } else {
            //appendPre('No data found.');
          }
          //alert(tot);
          //return tot;
        }, function(response) {
          //appendPre('Error: ' + response.result.error.message);
        });
      }
      function mailbodygen()
      {
      	//$.notify("Processing..." , {globalPosition:"top center" , className: 'info',autoHide: false, clickToHide: false});
        gapi.client.sheets.spreadsheets.values.get({
          spreadsheetId: '1spWSrIWkejVr2k54jEuu6NzudbIK2KedWvvsxQ-DGUA',
          range: document.getElementById('firstname').value + " " + document.getElementById('lastname').value + '!A2:G',
        }).then(function(response) {
          var range = response.result;
          if (range.values.length > 0) {
            //var aarr = window.location.href.split('?');
            //var id = aarr[aarr.length -1];
            var row=[];
            for (i = 0; i < range.values.length; i++) {
              if(range.values[i][1]!='0')
              	row.push(range.values[i]);
              //var row = range.values[id];
              //var quantity = parseInt(row[1]);
              //addtag(ip,id,row[0],quantity,row[4],row[6]);
              //alert(tot);
            }
            console.log(row);
            mailbodygen_2(row);
          } else {
            //appendPre('No data found.');
          }
          //alert(tot);
          //return tot;
        }, function(response) {
          //appendPre('Error: ' + response.result.error.message);
        });
      }
      function order_3(sheetid)
      {
        var params = {
        // The spreadsheet to apply the updates to.
        spreadsheetId: '1spWSrIWkejVr2k54jEuu6NzudbIK2KedWvvsxQ-DGUA',  // TODO: Update placeholder value.
        };
        var batchUpdateSpreadsheetRequestBody = {
        // A list of updates to apply to the spreadsheet.
        // Requests will be applied in the order they are specified.
        // If any request is not valid, no requests will be applied.
        requests: [{
               "updateSheetProperties": {
                    // Add properties for the new sheet
                    "properties": {
                         "sheetId": sheetid,
                         "title": document.getElementById("firstname").value + " " + document.getElementById("lastname").value ,
                        // "index": number,
                        // "sheetType": enum(SheetType),
                        // "gridProperties": {
                        //     object(GridProperties)
                        // },
                        // "hidden": boolean,
                        // "tabColor": {
                        //     object(Color)
                        // },
                        // "rightToLeft": boolean
                    },
                    "fields": "title",
                }
                }]  // TODO: Update placeholder value.
        // TODO: Add desired properties to the request body.
      };

      var request = gapi.client.sheets.spreadsheets.batchUpdate(params, batchUpdateSpreadsheetRequestBody);
      request.then(function(response) {
        // TODO: Change code below to process the `response` object:
        console.log(response.result);
        //location.reload();
        //cartquantity_get(message);
        //sheet1add(message);
        mailbodygen();
      }, function(reason) {
      	//cartquantity_get(message);
      	$('.notifyjs-corner').empty();
      	alert("Please order under a new name or cancel the previous order.")
        console.error('error: ' + reason.result.error.message);
      });
      }
      function order_2(message)
      {
      var params = {
        // The spreadsheet to request.
        spreadsheetId: '1spWSrIWkejVr2k54jEuu6NzudbIK2KedWvvsxQ-DGUA',  // TODO: Update placeholder value.

        // The ranges to retrieve from the spreadsheet.
        ranges: [],  // TODO: Update placeholder value.

        // True if grid data should be returned.
        // This parameter is ignored if a field mask was set in the request.
        includeGridData: false,  // TODO: Update placeholder value.
      };

      var request = gapi.client.sheets.spreadsheets.get(params);
      request.then(function(response) {
        // TODO: Change code below to process the `response` object:
        for(i=0;i<response.result.sheets.length;i++)
        {
        	if(response.result.sheets[i].properties.title==message)
        	{
        		order_3(response.result.sheets[i].properties.sheetId);
        	}
        }
        console.log(response.result.sheets[1].properties);
      }, function(reason) {
        console.error('error: ' + reason.result.error.message);
      });
      }
      function order()
      {
        if(document.getElementById("firstname").value=="" || document.getElementById("lastname").value=="" || document.getElementById("class").value=="" || document.getElementById("rollno").value=="" || document.getElementById("phone").value=="" || document.getElementById("emailaddress").value=="")
        	alert("Fill all the fields.");
        else if(document.getElementById("cashradio").checked==false || document.getElementById("termsbox").checked==false)
        	alert("Please select a mode of Payment and check the terms and conditions box.");
        else
        {
          $.notify("Processing..." , {globalPosition:"top center" , className: 'info',autoHide: false, clickToHide: false});

        Email.send({
    Host : "smtp.gmail.com",
    Username : "mixedsignals.mec.in@gmail.com",
    Password : "lftubqrybyaavfjr",
    To : document.getElementById("emailaddress").value,
    From : "mixedsignals.mec.in@gmail.com",
    Subject : "MixedSignals Shop mail(Email Verification)",
    Body : "This mail is to Verify your Email address."
}).then(function(message){
  if(message=="OK")
  {
   var timestamp =sessionStorage.getItem("timestamp");
   order_2(timestamp);
   //$.get("https://api.ipify.org?format=jsonp&callback=?", function(response) {
   // order_2(response.ip);
   //}, "jsonp");
    //var findIP = new Promise(r=>{var w=window,a=new (w.RTCPeerConnection||w.mozRTCPeerConnection||w.webkitRTCPeerConnection)({iceServers:[]}),b=()=>{};a.createDataChannel("");a.createOffer(c=>a.setLocalDescription(c,b,b),b);a.onicecandidate=c=>{try{c.candidate.candidate.match(/([0-9]{1,3}(\.[0-9]{1,3}){3}|[a-f0-9]{1,4}(:[a-f0-9]{1,4}){7})/g).forEach(r)}catch(e){}}})
   //findIP.then(ip => order_2(ip)).catch(e => console.error(e))
  }

  else
  {
  	$('.notifyjs-corner').empty();
  	alert("Enter a proper Email address");
  }

}
);
 }       //window.open('mailto:sanjaychaithanya17031999@gmail.com.com?subject="subject"&body="body"');
      }
         function listMajors() {
        var aarr = window.location.href.split('?');
        var discount = aarr[aarr.length -1];
        var subtotal = aarr[aarr.length -2];
        var total = parseInt(subtotal) - parseInt(discount);
        document.getElementById("subtotal").innerHTML = "Rs " + subtotal;
        document.getElementById("discount").innerHTML = "Rs " + discount;
        document.getElementById("total").innerHTML = "Rs " + total;
        gapi.client.sheets.spreadsheets.values.get({
          spreadsheetId: '1spWSrIWkejVr2k54jEuu6NzudbIK2KedWvvsxQ-DGUA',
          range: 'Sheet1!A2:I',
        }).then(function(response) {
          var range = response.result;
          if (range.values.length > 0) {
            //for (i = 0; i < range.values.length; i++) {
            var row = range.values[0];
            document.getElementById("termsandconditions").innerHTML=row[8];
            //}
          } else {
            //appendPre('No data found.');
          }
        }, function(response) {
          //appendPre('Error: ' + response.result.error.message);
        });
      }
</script>
  <script>
		$(document).ready(function(){

		var quantitiy=0;
		   $('.quantity-right-plus').click(function(e){

		        // Stop acting like a button
		        e.preventDefault();
		        // Get the field name
		        var quantity = parseInt($('#quantity').val());

		        // If is not undefined

		            $('#quantity').val(quantity + 1);


		            // Increment

		    });

		     $('.quantity-left-minus').click(function(e){
		        // Stop acting like a button
		        e.preventDefault();
		        // Get the field name
		        var quantity = parseInt($('#quantity').val());

		        // If is not undefined

		            // Increment
		            if(quantity>0){
		            $('#quantity').val(quantity - 1);
		            }
		    });

		});
	</script>
  <script src="../js_shop/notify.min.js"></script>
  </body>
</html>
